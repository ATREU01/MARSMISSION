import{dA as g,d9 as i,eE as E,d4 as m}from"./index-Cpv0zDxI.js";import{Q as x,R as b,z as B,X as S}from"./to-ui-error-CYFXznYy-BPRPu1j9.js";import"./PinInput-C3_MNxMt-Dfqbl5wP.js";import"./FingerPrintIcon-CtllU9JT.js";import"./PhoneIcon-CdbSo_yf.js";import"./ShieldCheckIcon-Dhm3Vd90.js";import"./ModalHeader-BTru6YQw-BHChfpN7.js";import"./ScreenLayout-CNho46nP-Dt3g6k8I.js";import"./Button-BCV6mjvS-Dszq2MTY.js";import"./Screen-_0H_rCdH-C2vR92kV.js";import"./index-CJMgUOnw-BrnuYJRU.js";import"./ExclamationTriangleIcon-BtuagLBw.js";import"./StackedContainer-BrIQsdas-DxS4v3u3.js";import"./useGetTokenPrice-CDPxMEO--C0dOX7-5.js";import"./useGetSolPrice-Cfm8o9C5-_toEvJx9.js";import"./TransactionDetails-BdW2lq_B-Cp_8nohP.js";import"./WalletLink-Cj92ni3W-FVre3OaF.js";import"./ethers-Bl5aM5Gz-BEGTJt4_.js";import"./getFormattedUsdFromLamports-B6EqSEho-C-HCdwKa.js";import"./transaction-CnfuREWo-nROljJQP.js";import"./Layouts-Bmf8DxNP-Oxchg1Qk.js";import"./ChevronDownIcon-BM4_-rgr.js";const U=({onClose:l})=>{let{user:r}=g(),[o,a]=i.useState(r?.mfaMethods[0]??null),{init:f,cancel:w,submit:p}=E(),[d,h]=i.useState(!1),[v,M]=i.useState(null),[n,s]=i.useState();i.useEffect((()=>{a(r?.mfaMethods[0]??null)}),[r?.mfaMethods]);let c=i.useRef(!1);async function y(t){s(void 0);try{if(!t||!o)return;await p(o,t),h(!0),s(void 0),l()}catch(e){throw S(e).error}}async function k(t){if(t!=="passkey")try{a(t),await f(t)}catch(e){console.error(e)}else try{a(t);let e=await f(t);if(!e)throw Error("something went wrong");M(e),await p(t,e),h(!0),s(void 0),l()}catch(e){s(S(e))}}i.useEffect((()=>{!c.current&&o&&(c.current=!0,k(o).finally((()=>{c.current=!1})))}),[]);let u=()=>{a(null),s(void 0),w(),l()};return r?o==="passkey"?m.jsx(x,{account:r.linkedAccounts.filter((t=>t.type==="passkey"&&t.enrolledInMfa)).sort(((t,e)=>e.firstVerifiedAt.valueOf()-t.firstVerifiedAt.valueOf()))[0],submitSuccess:d,hasBlockingError:n?.isBlocking??!1,error:n?.error,onClose:u,onBack:()=>{a(null),s(void 0)},handleSubmit:()=>y(v).catch(s)}):o?m.jsx(b,{submitSuccess:d,hasBlockingError:n?.isBlocking??!1,handleSubmitCode:y,selectedMethod:o,onClose:u,onBack:r.mfaMethods.length>1?()=>a(null):void 0}):m.jsx(B,{user:r,onSelect:k,handleClose:u}):null};export{U as MfaVerifyFlowScreen,U as default};
