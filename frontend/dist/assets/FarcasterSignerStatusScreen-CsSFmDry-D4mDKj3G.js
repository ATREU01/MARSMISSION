import{d4 as t,d5 as b,d6 as T,d7 as F,d9 as c,dw as w,dy as h,ds as o,dt as N}from"./index-Csq7o-74.js";import{p as O}from"./CopyToClipboard-DatKc59_-S6HLcEku.js";import{n as q}from"./OpenLink-BpeNYBKs-CYYPejbZ.js";import{x as B}from"./QrCode-Oxn5GT3C-Ce-pLO6x.js";import{n as E}from"./ScreenLayout-CNho46nP-BkLQB8bM.js";import{l as x}from"./farcaster-DPlSjvF5-BVEtFgio.js";import"./copy-Bx2Jwc5_-CqnU6fuv.js";import"./dijkstra-COg3n3zL.js";import"./Button-BCV6mjvS-C5r36cJa.js";import"./Screen-_0H_rCdH-DJPJq8sC.js";import"./ModalHeader-BTru6YQw-Bu34QJWb.js";import"./index-CJMgUOnw-CivuPpGJ.js";let C="#8a63d2";const M=({appName:d,loading:m,success:p,errorMessage:e,connectUri:a,onBack:r,onClose:n,onOpenFarcaster:s})=>t.jsx(E,h.isMobile||m?h.isIOS?{title:e?e.message:"Add a signer to Farcaster",subtitle:e?e.detail:`This will allow ${d} to add casts, likes, follows, and more on your behalf.`,icon:x,iconVariant:"loading",iconLoadingStatus:{success:p,fail:!!e},primaryCta:a&&s?{label:"Open Farcaster app",onClick:s}:void 0,onBack:r,onClose:n,watermark:!0}:{title:e?e.message:"Requesting signer from Farcaster",subtitle:e?e.detail:"This should only take a moment",icon:x,iconVariant:"loading",iconLoadingStatus:{success:p,fail:!!e},onBack:r,onClose:n,watermark:!0,children:a&&h.isMobile&&t.jsx(L,{children:t.jsx(q,{text:"Take me to Farcaster",url:a,color:C})})}:{title:"Add a signer to Farcaster",subtitle:`This will allow ${d} to add casts, likes, follows, and more on your behalf.`,onBack:r,onClose:n,watermark:!0,children:t.jsxs(_,{children:[t.jsx($,{children:a?t.jsx(B,{url:a,size:275,squareLogoElement:x}):t.jsx(R,{children:t.jsx(N,{})})}),t.jsxs(A,{children:[t.jsx(P,{children:"Or copy this link and paste it into a phone browser to open the Farcaster app."}),a&&t.jsx(O,{text:a,itemName:"link",color:C})]})]})});let L=o.div.withConfig({displayName:"MobileLinkContainer",componentId:"sc-2da6f06e-0"})(["margin-top:24px;"]),_=o.div.withConfig({displayName:"ContentContainer",componentId:"sc-2da6f06e-1"})(["display:flex;flex-direction:column;align-items:center;gap:24px;"]),$=o.div.withConfig({displayName:"QrContainer",componentId:"sc-2da6f06e-2"})(["padding:24px;position:relative;display:flex;align-items:center;justify-content:center;min-height:275px;"]),A=o.div.withConfig({displayName:"InstructionsContainer",componentId:"sc-2da6f06e-3"})(["display:flex;flex-direction:column;align-items:center;gap:16px;"]),P=o.div.withConfig({displayName:"InstructionText",componentId:"sc-2da6f06e-4"})(["font-size:0.875rem;text-align:center;color:var(--privy-color-foreground-2);"]),R=o.div.withConfig({displayName:"LoaderWrapper",componentId:"sc-2da6f06e-5"})(["position:relative;width:82px;height:82px;"]);const Z={component:()=>{let{lastScreen:d,navigateBack:m,data:p}=b(),e=T(),{requestFarcasterSignerStatus:a,closePrivyModal:r}=F(),[n,s]=c.useState(void 0),[k,v]=c.useState(!1),[S,y]=c.useState(!1),f=c.useRef([]),l=p?.farcasterSigner;c.useEffect((()=>{let j=Date.now(),i=setInterval((async()=>{if(!l?.public_key)return clearInterval(i),void s({retryable:!0,message:"Connect failed",detail:"Something went wrong. Please try again."});l.status==="approved"&&(clearInterval(i),v(!1),y(!0),f.current.push(setTimeout((()=>r({shouldCallAuthOnSuccess:!1,isSuccess:!0})),w)));let u=await a(l?.public_key),I=Date.now()-j;u.status==="approved"?(clearInterval(i),v(!1),y(!0),f.current.push(setTimeout((()=>r({shouldCallAuthOnSuccess:!1,isSuccess:!0})),w))):I>3e5?(clearInterval(i),s({retryable:!0,message:"Connect failed",detail:"The request timed out. Try again."})):u.status==="revoked"&&(clearInterval(i),s({retryable:!0,message:"Request rejected",detail:"The request was rejected. Please try again."}))}),2e3);return()=>{clearInterval(i),f.current.forEach((u=>clearTimeout(u)))}}),[]);let g=l?.status==="pending_approval"?l.signer_approval_url:void 0;return t.jsx(M,{appName:e.name,loading:k,success:S,errorMessage:n,connectUri:g,onBack:d?m:void 0,onClose:r,onOpenFarcaster:()=>{g&&(window.location.href=g)}})}};export{Z as FarcasterSignerStatusScreen,M as FarcasterSignerStatusView,Z as default};
