import{d5 as v,d7 as x,d9 as c,d4 as e,ds as p,dt as w,du as b,dv as j}from"./index-CyM-Smro.js";import{F as C}from"./ArrowsRightLeftIcon-DCupdOKJ.js";import{F}from"./CheckCircleIcon-BO8ayG8f.js";import{n as I}from"./Button-BCV6mjvS-DEy8TysZ.js";import{c as S}from"./Layouts-Bmf8DxNP-DOFIh9oz.js";import{y as k,s as D}from"./ModalHeader-BTru6YQw-B9zkFP1a.js";import{t as M}from"./analytics-mkkvFRju-DOXuftJB.js";const G={component:()=>{let{data:r,setModalData:t,navigate:n,navigateBack:o}=v(),{closePrivyModal:i,createAnalyticsEvent:l,client:h}=x(),[d,u]=c.useState("pending-in-flow"),m=c.useRef(0),a={...r?.funding,showAlternateFundingMethod:!0};a.usingDefaultFundingMethod&&(a.usingDefaultFundingMethod=!1);let{partnerUserId:f,popup:g}=r?.coinbaseOnrampStatus??{};return c.useEffect((()=>{if(d==="pending-in-flow"||d==="pending-after-flow"){let y=setInterval((async()=>{if(f)try{let{status:s}=await h.getCoinbaseOnRampStatus({partnerUserId:f});if(s==="success")return void u("success");if(s==="failure")throw Error("There was an error completing Coinbase Onramp flow.");if(m.current>=3)return t({funding:a,solanaFundingData:r?.solanaFundingData}),void n("FundingMethodSelectionScreen");g?.closed&&(m.current=m.current+1,u("pending-after-flow"))}catch(s){console.error(s),u("error"),l({eventName:M,payload:{status:"failure",provider:"coinbase-onramp",error:s.message}}),t({funding:{...a,errorMessage:"Something went wrong adding funds. Please try again or use another method."},solanaFundingData:r?.solanaFundingData}),n("FundingMethodSelectionScreen")}}),1500);return()=>clearInterval(y)}}),[f,g,d]),e.jsxs(e.Fragment,{children:[e.jsx(k,{title:"Fund account",backFn:()=>{t({funding:a,solanaFundingData:r?.solanaFundingData}),o()}},"header"),e.jsx(R,{status:d,onClickCta:i}),e.jsx(D,{})]})}};let R=({status:r,onClickCta:t})=>{let{title:n,body:o,cta:i}=c.useMemo((()=>(l=>{switch(l){case"success":return{title:"You've funded your account!",body:"It may take a few minutes for the assets to appear.",cta:"Continue"};case"pending-after-flow":return{title:"In Progress",body:"Almost done. Retrieving transaction status from Coinbase",cta:""};case"error":case"pending-in-flow":return{title:"In Progress",body:"Go back to Coinbase Onramp to finish funding your account.",cta:""}}})(r)),[r]);return e.jsxs(e.Fragment,{children:[e.jsxs(O,{children:[e.jsx(P,{isSucccess:r==="success"}),e.jsxs(S,{children:[e.jsx("h3",{children:n}),e.jsx(E,{children:o})]})]}),i&&e.jsx(I,{onClick:t,children:i})]})},P=({isSucccess:r})=>{if(!r){let o="var(--privy-color-foreground-4)";return e.jsxs("div",{style:{position:"relative"},children:[e.jsx(w,{color:o,style:{position:"absolute"}}),e.jsx(b,{color:o}),e.jsx(j,{style:{position:"absolute",width:"2.8rem",height:"2.8rem",top:"1.2rem",left:"1.2rem"}})]})}let t=r?F:()=>e.jsx(C,{width:"3rem",height:"3rem",style:{backgroundColor:"var(--privy-color-foreground-4)",color:"var(--privy-color-background)",borderRadius:"100%",padding:"0.5rem",margin:"0.5rem"}}),n=r?"var(--privy-color-success)":"var(--privy-color-foreground-4)";return e.jsx("div",{style:{borderColor:n,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"100%",borderWidth:2,padding:"0.5rem",marginBottom:"0.5rem"},children:t&&e.jsx(t,{width:"4rem",height:"4rem",color:n})})},E=p.p.withConfig({displayName:"StatusBody",componentId:"sc-e4350fdc-0"})(["font-size:1rem;color:var(--privy-color-foreground-3);margin-bottom:1rem;display:flex;flex-direction:column;gap:1rem;"]),O=p.div.withConfig({displayName:"ConnectContainer",componentId:"sc-e4350fdc-1"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;margin-left:1.75rem;margin-right:1.75rem;padding:2rem 0;"]);export{G as CoinbaseOnrampStatusScreen,G as default};
