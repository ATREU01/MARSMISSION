import{dc as z,d7 as j,eg as H,d5 as V,d6 as Y,d9 as i,dg as D,d4 as a,de as G,d3 as f,eh as J}from"./index-C6aulGjq.js";import{n as K}from"./Button-BCV6mjvS-QQOxW8LY.js";import{d as Q}from"./Layouts-Bmf8DxNP-ChOdzYv7.js";import{s as W}from"./ModalHeader-BTru6YQw-DkYP7_q4.js";import{x as X}from"./QrCode-Oxn5GT3C-CB1E9BHK.js";import{t as Z}from"./FundWalletMethodHeader-CS84Ots9-CxOCl_Ys.js";import{i as _}from"./InfoBanner-D6C6Bt8L-DGfuwDsG.js";import{t as ee}from"./Subtitle-DkvfP2Ev-HWIzc2N1.js";import{o as re}from"./Title-D0pfZff--OiqNSe8K.js";import{x as ae}from"./WalletInfoCard-COAfUoX0-CRg3Rjsv.js";import{s as ne}from"./useWalletBalance-CkNw6kj0-BdnHVJ5t.js";import{t as U}from"./analytics-mkkvFRju-DOXuftJB.js";import{e as se}from"./getChainName-DjpPdUSc-c2urPd0g.js";import{r as h}from"./getUsdcMintAddress-DFI1hv05-jlhpBW9a.js";import{t as te}from"./transaction-CnfuREWo-nROljJQP.js";import{n as ie}from"./getErc20Balance-CaKjNAs9-DD6SHTLU.js";import{i as b,t as oe}from"./formatters-C7Hc4LyW.js";import"./dijkstra-COg3n3zL.js";import"./ErrorMessage-Cx8GKGhL-CjzZL8D6.js";import"./LabelXs-BOisBtqT-C4ILARiC.js";import"./Address-BUmpXgsy-Dvnc0Oy0.js";import"./check-B-FJ1RU_.js";import"./createLucideIcon-D9llCs1E.js";import"./copy-miwUQLez.js";import"./shared-CtYf3O54-B8BPjlrq.js";import"./getFormattedUsdFromLamports-B6EqSEho-C-HCdwKa.js";const Be={component:()=>{let{wallets:c}=z(),{connectors:w}=j(),A=w.filter(H).flatMap((s=>s.wallets)),{data:d,setModalData:F,navigate:M,lastScreen:k}=V(),{rpcConfig:g,appId:C,createAnalyticsEvent:v,closePrivyModal:E}=j(),y=Y(),[r,l]=i.useState(void 0),[B,S]=i.useState(!1),e=d?.funding,{reloadBalance:O}=ne({rpcConfig:g,appId:C,address:e.chainType==="ethereum"?e.address:void 0,chain:e.chainType==="ethereum"?e.chain:void 0}),o=e.chainType==="solana",m=o?e.isUSDC?"USDC":"SOL":e.erc20Address?e.erc20ContractInfo?.symbol:e.chain.nativeCurrency.symbol,$=o?A.find((({address:s})=>s===e.address)):c.find((({address:s})=>D(s)===D(e.address)));if(!e)return F({errorModalData:{error:Error("Couldn't find funding config"),previousScreen:k||"FundingMethodSelectionScreen"},funding:d?.funding,solanaFundingData:d?.solanaFundingData,sendTransaction:d?.sendTransaction}),M("ErrorScreen"),a.jsx(a.Fragment,{});i.useEffect((()=>{let s=o?async function(){if(e.chainType!=="solana")return;let n=y.solanaRpcs[e.chain];n?(e.isUSDC?(async function({rpc:p,address:t,mintAddress:R}){let q=await p.getTokenAccountsByOwner(t,{mint:R},{encoding:"jsonParsed",commitment:"confirmed"}).send(),I=q.value[0]?.account;return I?BigInt(I.data.parsed.info.tokenAmount.amount):0n})({rpc:n.rpc,address:e.address,mintAddress:h(e.chain)}):G({rpc:n.rpc,address:e.address})).then((p=>{let t=BigInt(p);r&&t>r&&(S(!0),v({eventName:U,payload:{provider:"manual",status:"success",chainType:"solana",address:$?.address,value:e.isUSDC?f(t-r,6):f(t-r,9),token:e.isUSDC?"USDC":"SOL"}})),l(t)})):console.warn("Unable to load solana rpc, skipping balance")}:async function(){e.chainType==="ethereum"&&(async()=>{if(!e.erc20Address)return await O()??BigInt(0);{let{balance:n}=await ie({chain:e.chain,address:e.address,erc20Address:e.erc20Address,rpcConfig:g,appId:C});return n}})().then((n=>{r&&n>r&&(S(!0),v({eventName:U,payload:{provider:"manual",status:"success",chainType:"ethereum",address:$?.address,chainId:e.chain.id,value:f(n-r,e.erc20ContractInfo?.decimals??18),token:e.erc20ContractInfo?.symbol??e.erc20Address??"ETH"}})),l(n)})).catch((()=>l(void 0)))},P=setInterval(s,2e3);return s(),()=>clearInterval(P)}),[r]);let L=i.useMemo((()=>r==null?"":e.isUSDC?b({amount:r,decimals:6}):o?te(r,3,!0,!0):e.erc20ContractInfo?.decimals!=null?b({amount:r,decimals:e.erc20ContractInfo.decimals}):oe({wei:r})),[r,o,e]),u=e.chainType==="ethereum"?e.chain.name:se(e.chain),x=i.useMemo((()=>e.uiConfig?.receiveFundsTitle===""?null:a.jsx(re,{children:e.uiConfig?.receiveFundsTitle??`Receive ${e.amount} ${m??""}`.trim()})),[e.uiConfig?.receiveFundsTitle,e.amount,m]),T=i.useMemo((()=>e.uiConfig?.receiveFundsSubtitle===""?null:a.jsx(ee,{children:e.uiConfig?.receiveFundsSubtitle??`Scan this code or copy your wallet address to receive funds on ${u}.`})),[e.uiConfig?.receiveFundsSubtitle,u]),N=e.chainType==="solana"&&e.isUSDC&&h(e.chain)?`?spl-token=${h(e.chain)}`:"";return a.jsxs(a.Fragment,{children:[a.jsx(Z,{}),x,T,a.jsxs(Q,{style:{gap:"1rem",margin:x||T?"1rem 0":"0"},children:[a.jsx(X,{url:`${e.chainType}:${e.address}${N}`,size:200,squareLogoElement:de}),a.jsxs(_,{theme:y.appearance.palette.colorScheme,children:["Make sure to send funds on ",u,"."]}),a.jsx(ae,{title:"Your wallet",errMsg:void 0,showCopyButton:!0,balance:`${L} ${m}`,address:e.address}),B&&a.jsx(K,{onClick:()=>E({shouldCallAuthOnSuccess:!1,isSuccess:!0}),children:"Continue"})]}),a.jsx(W,{})]})}};let de=({...c})=>a.jsx(J,{color:"black",...c});export{Be as ManualTransferScreen,Be as default};
