import{d5 as I,d6 as M,d9 as a,dA as T,d7 as W,d4 as L,dL as R,dW as S}from"./index-CmAhqgXz.js";import{t as j}from"./use-create-wallet-without-fallback-C0dI_RFZ-DNMG0RAP.js";import{p as $,o as D}from"./SetWalletPasswordForm-vaG_68V0-CtbLrym8.js";import"./ExclamationTriangleIcon-Cq54eMkI.js";import"./Layouts-Bmf8DxNP-DlEYzfZu.js";import"./ModalHeader-BTru6YQw-BpO7CAfA.js";import"./shared-D8TfUpfU-BcwKguP0.js";import"./Button-BCV6mjvS-C8I5Wwg0.js";import"./Checkbox-NmGCZeKL-BoKX_o6_.js";import"./CheckCircleIcon-DtO_hoPv.js";import"./ScreenHeader-Biz1wq02-BqcgIa1W.js";const J={component:()=>{let{navigate:d,data:v,onUserCloseViaDialogOrKeybindRef:C}=I(),P=M(),[g,x]=a.useState(""),[c,u]=a.useState(!1),[s,h]=a.useState(),[n,b]=a.useState(null),{create:r}=j(),{authenticated:p,user:o}=T(),{closePrivyModal:l,isNewUserThisSession:E,initializeWalletProxy:U}=W(),{onSuccess:m,onFailure:i,callAuthOnSuccessOnClose:w,shouldCreateEth:f,shouldCreateSol:y}=v.createWallet,[t,A]=a.useState(null),O=new R((async()=>{try{let e;if(f&&y)e=await r({recoveryMethod:"user-passcode",recoveryPassword:s,chainType:"ethereum",walletIndex:0,latestUser:o}),e=await r({chainType:"solana",walletIndex:0,latestUser:e.user});else if(y)e=await r({recoveryMethod:"user-passcode",recoveryPassword:s,chainType:"solana",walletIndex:0,latestUser:o});else{if(!f)throw Error("Invalid args to create wallet");e=await r({recoveryMethod:"user-passcode",recoveryPassword:s,chainType:"ethereum",walletIndex:0,latestUser:o})}A(e),E?d("EmbeddedWalletCreatedScreen"):(m(e),l({shouldCallAuthOnSuccess:w}))}catch(e){x(e.message)}}));return a.useEffect((()=>{n||U(3e4).then((e=>b(e)))}),[n]),a.useEffect((()=>{if(!p||!o)return d("LandingScreen"),void i(Error("User must be authenticated before creating a Privy wallet"))}),[p]),C.current=()=>null,L.jsx($,{config:{initiatedBy:"automatic"},appName:P?.name||"privy",loading:!n,buttonLoading:c,buttonHideAnimations:!t&&c,isResettingPassword:!1,error:g,password:s||"",onClose:()=>{t&&t.account.recoveryMethod!=="user-passcode"?(i(new S("User created a wallet but failed to set a password for it")),l({shouldCallAuthOnSuccess:!1})):t?(m(t),l({shouldCallAuthOnSuccess:w})):(i(new S("User wallet creation failed")),l({shouldCallAuthOnSuccess:!1}))},onPasswordChange:h,onPasswordGenerate:()=>h(D()),onSubmit:async()=>(u(!0),O.execute().then((()=>new Promise((e=>setTimeout(e,250))))).finally((()=>u(!1))))})}};export{J as EmbeddedWalletPasswordCreateScreen,J as default};
