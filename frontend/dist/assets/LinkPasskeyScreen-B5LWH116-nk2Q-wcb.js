import{ds as a,d4 as e,d$ as b,dA as j,d7 as I,d9 as h,da as v,db as k,d_ as N}from"./index-Cpv0zDxI.js";import{a as P,s as x}from"./TodoList-Dn0Qu-vv-BXST9eDA.js";import{n as L}from"./ScreenLayout-CNho46nP-Dt3g6k8I.js";import{C as E}from"./circle-check-big-DuSdBhlZ.js";import{F as w}from"./fingerprint-pattern-APpJp4mJ.js";import{c as S}from"./createLucideIcon-CExn7AN7.js";import"./check-BKpdwUrS.js";import"./Button-BCV6mjvS-Dszq2MTY.js";import"./Screen-_0H_rCdH-C2vR92kV.js";import"./ModalHeader-BTru6YQw-BHChfpN7.js";import"./index-CJMgUOnw-BrnuYJRU.js";const A=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],W=S("trash-2",A),B=({passkeys:s,isLoading:d,errorReason:m,success:y,expanded:i,onLinkPasskey:l,onUnlinkPasskey:r,onExpand:n,onBack:t,onClose:o})=>e.jsx(L,y?{title:"Passkeys updated",icon:E,iconVariant:"success",primaryCta:{label:"Done",onClick:o},onClose:o,watermark:!0}:i?{icon:w,title:"Your passkeys",onBack:t,onClose:o,watermark:!0,children:e.jsx(C,{passkeys:s,expanded:i,onUnlink:r,onExpand:n})}:{icon:w,title:"Set up passkey verification",subtitle:"Verify with passkey",primaryCta:{label:"Add new passkey",onClick:l,loading:d},onClose:o,watermark:!0,helpText:m||void 0,children:s.length===0?e.jsx(_,{}):e.jsx(M,{children:e.jsx(C,{passkeys:s,expanded:i,onUnlink:r,onExpand:n})})});let M=a.div.withConfig({displayName:"ContentContainer",componentId:"sc-a752cbd1-0"})(["margin-bottom:12px;"]),C=({passkeys:s,expanded:d,onUnlink:m,onExpand:y})=>{let[i,l]=h.useState([]),r=d?s.length:2;return e.jsxs("div",{children:[e.jsx(z,{children:"Your passkeys"}),e.jsxs(V,{children:[s.slice(0,r).map((n=>{return e.jsxs(O,{children:[e.jsxs("div",{children:[e.jsx($,{children:(t=n,t.authenticatorName?t.createdWithBrowser?`${t.authenticatorName} on ${t.createdWithBrowser}`:t.authenticatorName:t.createdWithBrowser?t.createdWithOs?`${t.createdWithBrowser} on ${t.createdWithOs}`:`${t.createdWithBrowser}`:"Unknown device")}),e.jsxs(D,{children:["Last used:"," ",(n.latestVerifiedAt??n.firstVerifiedAt)?.toLocaleString()??"N/A"]})]}),e.jsx(R,{disabled:i.includes(n.credentialId),onClick:()=>(async o=>{l((p=>p.concat([o]))),await m(o),l((p=>p.filter((u=>u!==o))))})(n.credentialId),children:i.includes(n.credentialId)?e.jsx(N,{}):e.jsx(W,{size:16})})]},n.credentialId);var t})),s.length>2&&!d&&e.jsx(U,{onClick:y,children:"View all"})]})]})},_=()=>e.jsxs(P,{style:{color:"var(--privy-color-foreground)"},children:[e.jsx(x,{children:"Verify with Touch ID, Face ID, PIN, or hardware key"}),e.jsx(x,{children:"Takes seconds to set up and use"}),e.jsx(x,{children:"Use your passkey to verify transactions and login to your account"})]});const ne={component:()=>{let{user:s,unlinkPasskey:d}=j(),{linkWithPasskey:m,closePrivyModal:y}=I(),i=s?.linkedAccounts.filter((c=>c.type==="passkey")),[l,r]=h.useState(!1),[n,t]=h.useState(""),[o,p]=h.useState(!1),[u,f]=h.useState(!1);return h.useEffect((()=>{i.length===0&&f(!1)}),[i.length]),e.jsx(B,{passkeys:i,isLoading:l,errorReason:n,success:o,expanded:u,onLinkPasskey:()=>{r(!0),m().then((()=>p(!0))).catch((c=>{if(c instanceof v){if(c.privyErrorCode===k.CANNOT_LINK_MORE_OF_TYPE)return void t("Cannot link more passkeys to account.");if(c.privyErrorCode===k.PASSKEY_NOT_ALLOWED)return void t("Passkey request timed out or rejected by user.")}t("Unknown error occurred.")})).finally((()=>{r(!1)}))},onUnlinkPasskey:async c=>(r(!0),await d(c).then((()=>p(!0))).catch((g=>{g instanceof v&&g.privyErrorCode===k.MISSING_MFA_CREDENTIALS?t("Cannot unlink a passkey enrolled in MFA"):t("Unknown error occurred.")})).finally((()=>{r(!1)}))),onExpand:()=>f(!0),onBack:()=>f(!1),onClose:()=>y()})}},ie=a.div.withConfig({displayName:"DoubleIconWrapper",componentId:"sc-a752cbd1-1"})(["display:flex;align-items:center;justify-content:center;width:180px;height:90px;border-radius:50%;svg + svg{margin-left:12px;}> svg{z-index:2;color:var(--privy-color-accent) !important;stroke:var(--privy-color-accent) !important;fill:var(--privy-color-accent) !important;}"]);let T=b(["&&{width:100%;font-size:0.875rem;line-height:1rem;@media (min-width:440px){font-size:14px;}display:flex;gap:12px;justify-content:center;padding:6px 8px;background-color:var(--privy-color-background);transition:background-color 200ms ease;color:var(--privy-color-accent) !important;:focus{outline:none;box-shadow:none;}}"]);const U=a.button.withConfig({displayName:"LinkButton",componentId:"sc-a752cbd1-2"})(["",""],T);let V=a.div.withConfig({displayName:"List",componentId:"sc-a752cbd1-3"})(["display:flex;flex-direction:column;align-items:stretch;gap:0.8rem;padding:0.5rem 0rem 0rem;flex-grow:1;width:100%;"]),z=a.div.withConfig({displayName:"PasskeyListTitle",componentId:"sc-a752cbd1-4"})(["line-height:20px;height:20px;font-size:1em;font-weight:450;display:flex;justify-content:flex-beginning;width:100%;"]),$=a.div.withConfig({displayName:"PasskeyItemTitle",componentId:"sc-a752cbd1-5"})(["font-size:1em;line-height:1.3em;font-weight:500;color:var(--privy-color-foreground-2);padding:0.2em 0;"]),D=a.div.withConfig({displayName:"PasskeyItemSubtitle",componentId:"sc-a752cbd1-6"})(["font-size:0.875rem;line-height:1rem;color:#64668b;padding:0.2em 0;"]),O=a.div.withConfig({displayName:"PasskeyListItem",componentId:"sc-a752cbd1-7"})(["display:flex;align-items:center;justify-content:space-between;padding:1em;gap:10px;font-size:0.875rem;line-height:1rem;text-align:left;border-radius:8px;border:1px solid #e2e3f0 !important;width:100%;height:5em;"]),F=b([":focus,:hover,:active{outline:none;}display:flex;width:2em;height:2em;justify-content:center;align-items:center;svg{color:var(--privy-color-error);}svg:hover{color:var(--privy-color-foreground-3);}"]),R=a.button.withConfig({displayName:"PasskeyItemUnlinkButton",componentId:"sc-a752cbd1-8"})(["",""],F);export{ie as DoubleIconWrapper,U as LinkButton,ne as LinkPasskeyScreen,B as LinkPasskeyView,ne as default};
