import{d4 as t,dA as L,d7 as M,d5 as U,d9 as r,eY as A,dG as C,ew as w,ex as b,dw as O,ds as u,bX as k,cb as z,eZ as P}from"./index-C-PkIITX.js";import{p as $}from"./CopyToClipboard-DatKc59_-D9e5Z9nL.js";import{c as q}from"./Layouts-Bmf8DxNP-D_0NierX.js";import{n as F,i as J}from"./JsonTree-Bvd2C29R-CYK6O-cp.js";import{n as V}from"./ScreenLayout-CNho46nP-CF7mgIpA.js";import{c as H}from"./createLucideIcon-RaaGAKSy.js";import"./copy-Bx2Jwc5_-DSzx6kYu.js";import"./Button-BCV6mjvS-DgorNKOJ.js";import"./Screen-_0H_rCdH-BFi3iBxq.js";import"./ModalHeader-BTru6YQw-ioUJcRbG.js";import"./index-CJMgUOnw-D11NANlF.js";const G=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],K=H("square-pen",G),Q=u.img.withConfig({displayName:"StyledLogo",componentId:"sc-68c1b1ea-0"})(["&&{height:",";width:",";border-radius:16px;margin-bottom:12px;}"],(e=>e.size==="sm"?"65px":"140px"),(e=>e.size==="sm"?"65px":"140px"));let W=e=>{if(!k(e))return e;try{let a=z(e);return a.includes("�")?e:a}catch{return e}},X=e=>{try{let a=P.decode(e),s=new TextDecoder().decode(a);return s.includes("�")?e:s}catch{return e}},Y=e=>{let{types:a,primaryType:s,...l}=e.typedData;return t.jsxs(t.Fragment,{children:[t.jsx(te,{data:l}),t.jsx($,{text:(i=e.typedData,JSON.stringify(i,null,2)),itemName:"full payload to clipboard"})," "]});var i};const Z=({method:e,messageData:a,copy:s,iconUrl:l,isLoading:i,success:g,walletProxyIsLoading:m,errorMessage:x,isCancellable:d,onSign:c,onCancel:y,onClose:p})=>t.jsx(V,{title:s.title,subtitle:s.description,showClose:!0,onClose:p,icon:K,iconVariant:"subtle",helpText:x?t.jsx(ee,{children:x}):void 0,primaryCta:{label:s.buttonText,onClick:c,disabled:i||g||m,loading:i},secondaryCta:d?{label:"Not now",onClick:y,disabled:i||g||m}:void 0,watermark:!0,children:t.jsxs(q,{children:[l?t.jsx(Q,{style:{alignSelf:"center"},size:"sm",src:l,alt:"app image"}):null,t.jsxs(B,{children:[e==="personal_sign"&&t.jsx(T,{children:W(a)}),e==="eth_signTypedData_v4"&&t.jsx(Y,{typedData:a}),e==="solana_signMessage"&&t.jsx(T,{children:X(a)})]})]})}),ge={component:()=>{let{authenticated:e}=L(),{initializeWalletProxy:a,closePrivyModal:s}=M(),{navigate:l,data:i,onUserCloseViaDialogOrKeybindRef:g}=U(),[m,x]=r.useState(!0),[d,c]=r.useState(""),[y,p]=r.useState(),[f,E]=r.useState(null),[R,S]=r.useState(!1);r.useEffect((()=>{e||l("LandingScreen")}),[e]),r.useEffect((()=>{a(A).then((n=>{x(!1),n||(c("An error has occurred, please try again."),p(new C(new w(d,b.E32603_DEFAULT_INTERNAL_ERROR.eipCode))))}))}),[]);let{method:_,data:v,confirmAndSign:j,onSuccess:N,onFailure:D,uiOptions:o}=i.signMessage,I={title:o?.title||"Sign message",description:o?.description||"Signing this message will not cost you any fees.",buttonText:o?.buttonText||"Sign and continue"},h=n=>{n?N(n):D(y||new C(new w("The user rejected the request.",b.E4001_USER_REJECTED_REQUEST.eipCode))),s({shouldCallAuthOnSuccess:!1}),setTimeout((()=>{E(null),c(""),p(void 0)}),200)};return g.current=()=>{h(f)},t.jsx(Z,{method:_,messageData:v,copy:I,iconUrl:o?.iconUrl&&typeof o.iconUrl=="string"?o.iconUrl:void 0,isLoading:R,success:f!==null,walletProxyIsLoading:m,errorMessage:d,isCancellable:o?.isCancellable,onSign:async()=>{S(!0),c("");try{let n=await j();E(n),S(!1),setTimeout((()=>{h(n)}),O)}catch(n){console.error(n),c("An error has occurred, please try again."),p(new C(new w(d,b.E32603_DEFAULT_INTERNAL_ERROR.eipCode))),S(!1)}},onCancel:()=>h(null),onClose:()=>h(f)})}};let B=u.div.withConfig({displayName:"MessageContainer",componentId:"sc-124260c0-0"})(["flex:1;display:flex;flex-direction:column;gap:16px;"]),ee=u.p.withConfig({displayName:"ErrorText",componentId:"sc-124260c0-1"})(["&&{margin:0;width:100%;text-align:center;color:var(--privy-color-error-dark);font-size:14px;line-height:22px;}"]),te=u(F).withConfig({displayName:"StyledDisplayJsonTree",componentId:"sc-124260c0-2"})(["margin-top:0;"]),T=u(J).withConfig({displayName:"StyledMessage",componentId:"sc-124260c0-3"})(["margin-top:0;"]);export{ge as SignRequestScreen,Z as SignRequestView,ge as default};
