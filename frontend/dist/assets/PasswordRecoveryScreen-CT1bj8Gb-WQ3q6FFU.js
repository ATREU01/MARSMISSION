import{d9 as a,dA as k,d7 as E,d5 as R,d4 as e,ds as p,ei as T,ej as _,dW as F,d$ as U}from"./index-Cax8jish.js";import{F as W}from"./ShieldCheckIcon-wK5CydYC.js";import{n as M}from"./Button-BCV6mjvS-Ds3dQ567.js";import{p as O}from"./Layouts-Bmf8DxNP-u0w-Y0s6.js";import{f as V,m as B,u as H,b as z,I as D}from"./shared-D8TfUpfU-DDWRFGze.js";import{w as s}from"./Screen-_0H_rCdH-BcqDJQ68.js";import"./ModalHeader-BTru6YQw-VHe3yaAt.js";import"./index-CJMgUOnw-Caq7k6r0.js";const te={component:()=>{let[o,u]=a.useState(!0),{authenticated:h,user:g}=k(),{walletProxy:m,closePrivyModal:y,createAnalyticsEvent:f,client:j}=E(),{navigate:b,data:C,onUserCloseViaDialogOrKeybindRef:A}=R(),[n,I]=a.useState(void 0),[v,l]=a.useState(""),[d,x]=a.useState(!1),{entropyId:c,entropyIdVerifier:P,onCompleteNavigateTo:w,onSuccess:S,onFailure:$}=C.recoverWallet,i=(r="User exited before their wallet could be recovered")=>{y({shouldCallAuthOnSuccess:!1}),$(typeof r=="string"?new F(r):r)};return A.current=i,a.useEffect((()=>{if(!h)return i("User must be authenticated and have a Privy wallet before it can be recovered")}),[h]),e.jsxs(s,{children:[e.jsx(s.Header,{icon:W,title:"Enter your password",subtitle:"Please provision your account on this new device. To continue, enter your recovery password.",showClose:!0,onClose:i}),e.jsx(s.Body,{children:e.jsx(K,{children:e.jsxs("div",{children:[e.jsxs(V,{children:[e.jsx(B,{type:o?"password":"text",onChange:r=>(t=>{t&&I(t)})(r.target.value),disabled:d,style:{paddingRight:"2.3rem"}}),e.jsx(H,{style:{right:"0.75rem"},children:o?e.jsx(z,{onClick:()=>u(!1)}):e.jsx(D,{onClick:()=>u(!0)})})]}),!!v&&e.jsx(Y,{children:v})]})})}),e.jsxs(s.Footer,{children:[e.jsx(s.HelpText,{children:e.jsxs(O,{children:[e.jsx("h4",{children:"Why is this necessary?"}),e.jsx("p",{children:"You previously set a password for this wallet. This helps ensure only you can access it"})]})}),e.jsx(s.Actions,{children:e.jsx(q,{loading:d||!m,disabled:!n,onClick:async()=>{x(!0);let r=await j.getAccessToken(),t=T(g,c);if(!r||!t||n===null)return i("User must be authenticated and have a Privy wallet before it can be recovered");try{f({eventName:"embedded_wallet_recovery_started",payload:{walletAddress:t.address}}),await m?.recover({accessToken:r,entropyId:c,entropyIdVerifier:P,recoveryPassword:n}),l(""),w?b(w):y({shouldCallAuthOnSuccess:!1}),S?.(t),f({eventName:"embedded_wallet_recovery_completed",payload:{walletAddress:t.address}})}catch(N){_(N)?l("Invalid recovery password, please try again."):l("An error has occurred, please try again.")}finally{x(!1)}},$hideAnimations:!c&&d,children:"Recover your account"})}),e.jsx(s.Watermark,{})]})]})}};let K=p.div.withConfig({displayName:"Content",componentId:"sc-1247f710-0"})(["display:flex;flex-direction:column;gap:1.5rem;"]),Y=p.div.withConfig({displayName:"ErrorMessage",componentId:"sc-1247f710-1"})(["line-height:20px;height:20px;font-size:13px;color:var(--privy-color-error);text-align:left;margin-top:0.5rem;"]),q=p(M).withConfig({displayName:"NoAnimationPrimaryButton",componentId:"sc-1247f710-2"})(["",""],(({$hideAnimations:o})=>o&&U(["&&{transition:none;}"])));export{te as PasswordRecoveryScreen,te as default};
