import{d9 as u,d7 as v,d5 as A,eb as F,ec as w,ed as M,ee as S,ef as x}from"./index-BCkNtVKb.js";import{t as y}from"./analytics-mkkvFRju-DOXuftJB.js";const f="moonpay";function D(t){return parseFloat(t)}function I(t,s=!1){let[g,p]=u.useState(null),{createAnalyticsEvent:i}=v(),{data:a,navigate:d,setModalData:c}=A(),l=a?.funding,r=u.useRef(0);return u.useEffect((()=>{let o=setInterval((async()=>{if(t)try{let[e]=await(async function(h,m){return F(`${m?w:M}/transactions/ext/${h}`,{query:{apiKey:m?S:x}})})(t,s),n=e.status==="waitingAuthorization"&&e.paymentMethod==="credit_debit_card"?"pending":e.status;if(["failed","completed","awaitingAuthorization"].includes(n)&&(i({eventName:y,payload:{status:n,provider:f,paymentMethod:e.paymentMethod,cardPaymentType:e.cardPaymentType,currency:e.currency?.code,baseCurrencyAmount:e.baseCurrencyAmount,quoteCurrencyAmount:e.quoteCurrencyAmount,feeAmount:e.feeAmount,extraFeeAmount:e.extraFeeAmount,networkFeeAmount:e.networkFeeAmount,isSandbox:s}}),clearInterval(o)),n==="failed"||n==="serviceFailure")return c({funding:{...l,errorMessage:"Something went wrong adding funds from Moonpay. Please try again or use another method to fund your wallet."},solanaFundingData:a?.solanaFundingData}),void d("FundingMethodSelectionScreen");p(n)}catch(e){e.response?.status!==404&&(r.current+=1),r.current>=3&&(i({eventName:y,payload:{status:"serviceFailure",provider:f}}),clearInterval(o),c({funding:{...l,errorMessage:"Something went wrong adding funds from Moonpay. Please try again or use another method to fund your wallet."},solanaFundingData:a?.solanaFundingData}),d("FundingMethodSelectionScreen"))}}),3e3);return()=>clearInterval(o)}),[t,r]),g}export{D as l,I as y};
